<!DOCTYPE html>
{#{% extends 'bike_app/index.html' %}#}
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Find Ride</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=**&libraries=places&callback=initMap"async defer></script>


    <style>
        #map {
            height: calc(100vh - 60px);
            width: 50%;
            margin-left: auto;

        }
    </style>
</head>
<body>
<title>Find a ride</title>
<form action="/find_ride/" method="post">
    {% csrf_token %}
    {% load bootstrap4 %}
    {% bootstrap_css %}
    {% bootstrap_javascript jquery='full' %}
    {{ form }}
    {{ form.media }}{# Adds date-picker required JS and CSS #}
    <input type="submit" value="Submit" id="submitbutton">
</form>
</div>
<div id="map"></div>
<div id="infowindow-content">
    <img src="" width="16" height="16" id="place-icon">
    <span id="place-name" class="title"></span><br>
    <span id="place-address"></span>
</div>

<script>

    function initMap() {

        var input = document.getElementById('id_pickup');
        var dropoff = document.getElementById('id_dropoff');
        var autocomplete_pickup = new google.maps.places.Autocomplete(input);
        var autocomplete_dropoff = new google.maps.places.Autocomplete(dropoff);


    };
</script>



<script>
    $("#submitbutton").click(function() {

        var csrf_token = '{{csrf_token}}';
        var pickup = new google.maps.places.Autocomplete($("#id_pickup").val());
        var dropoff = $("#id_dropoff").val();
        var date = $("#id_date").val();
        var time = $("#id_time").val();

        $.ajax({
            headers: { "X-CSRFToken": csrf_token },
            type: "POST",
            url: "/find_ride",
            async: true,
            data: {
                pickup: pickup,
                dropoff: dropoff,
                date: date,
                time: time
            },
            success: function(data) {

                console.log('Success');

                {#new Chart(document.getElementById("line-chart"), {#}
                {#    type: data['type'],#}
                {#    data: {#}
                {#        labels: data['data']['labels'],#}
                {#        datasets: [{#}
                {#            data: data['data']['datasets'][0]['data'],#}
                {#            label: data['data']['datasets'][0]['label'],#}
                {#            borderColor: data['data']['datasets'][0]['borderColor'],#}
                {#            fill: false#}
                {#        }]#}
                {#    },#}
                {#    options: {#}
                {#        title: {#}
                {#            display: true,#}
                {#            text: 'Exchange Rate Forecast'#}
                {#        }#}
                {#    }#}
                {#});#}





            }
        });
    });

</script>
</body>
</html>

